[gd_scene load_steps=45 format=3 uid="uid://cjgcqq3o1837l"]

[ext_resource type="PackedScene" uid="uid://b0dqe05b86gyt" path="res://objects/common/gun.tscn" id="1_aybfs"]
[ext_resource type="Script" path="res://objects/enemies/enemy.gd" id="1_nlux1"]
[ext_resource type="EventAsset" uid="uid://b8s1pbvmju7bb" path="res://addons/FMOD/editor/resources/events/{1c4f5690-8aae-455e-83f0-cbcc1f63f5b6}.tres" id="2_nejo3"]
[ext_resource type="PackedScene" uid="uid://bmd03mfrn325s" path="res://objects/common/attack.tscn" id="3_stq0h"]
[ext_resource type="PackedScene" uid="uid://4v1dhdlky4sl" path="res://objects/common/box.tscn" id="4_16kiu"]
[ext_resource type="Material" uid="uid://cqbc6u6k8lsmp" path="res://objects/common/particles/particles_material.tres" id="4_ioxtw"]
[ext_resource type="PackedScene" uid="uid://bxs7ih6h1ojsg" path="res://objects/common/fotonic_projectile.tscn" id="4_lav24"]
[ext_resource type="EventAsset" uid="uid://m46ixpnvs7qm" path="res://addons/FMOD/editor/resources/events/{dc0a89a3-05be-44bd-9fe6-4e1c686d7955}.tres" id="4_tif1u"]
[ext_resource type="Script" path="res://objects/common/hitbox.gd" id="5_akkc2"]
[ext_resource type="Texture2D" uid="uid://wladwpjjgaa" path="res://objects/common/particles/sparkles_colors_1.tres" id="5_ny0xu"]
[ext_resource type="PackedScene" uid="uid://cd2li80rf5gwo" path="res://objects/common/health_bar.tscn" id="6_kvpei"]
[ext_resource type="PackedScene" uid="uid://dokek0pfjolrv" path="res://objects/common/following_brain.tscn" id="7_5nhoc"]
[ext_resource type="PackedScene" uid="uid://le0ve457ae3g" path="res://models/mk1/mk1_mesh.tscn" id="7_v8gqy"]
[ext_resource type="PackedScene" uid="uid://cuthnbuh2wmht" path="res://objects/common/attacker_animation_tree.tscn" id="8_2jfml"]
[ext_resource type="EventAsset" uid="uid://28ow7w04xojo" path="res://addons/FMOD/editor/resources/events/{cc94d5ab-f44b-4107-8d6f-9bba0057010b}.tres" id="8_em8a2"]
[ext_resource type="PackedScene" uid="uid://ir1rhi0onuum" path="res://objects/common/attacking_brain.tscn" id="8_okm3w"]
[ext_resource type="Script" path="res://objects/common/stats.gd" id="9_q1fbs"]
[ext_resource type="EventAsset" uid="uid://b5lwuu2q5t7ya" path="res://addons/FMOD/editor/resources/events/{35370fea-686f-4097-8ec6-d51475762293}.tres" id="11_mumii"]
[ext_resource type="PackedScene" uid="uid://bqjcj417e22e0" path="res://objects/common/shield.tscn" id="12_2fip4"]
[ext_resource type="EventAsset" uid="uid://bfsgc7pl13n55" path="res://addons/FMOD/editor/resources/events/{84c5df55-5467-400c-9ff7-c0a47971c23d}.tres" id="12_5capb"]
[ext_resource type="PackedScene" uid="uid://6i15mylsminn" path="res://objects/common/wandering_brain.tscn" id="13_bb7j5"]
[ext_resource type="PackedScene" uid="uid://dpkytjeiftwqx" path="res://objects/common/avoiding_brain.tscn" id="14_6tyvy"]
[ext_resource type="Texture2D" uid="uid://bmts30bnbno61" path="res://icons/mk1.png" id="22_sufty"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_mjw7r"]
radius = 1.0
height = 3.0

[sub_resource type="Gradient" id="Gradient_e8g6m"]
interpolation_mode = 2
offsets = PackedFloat32Array(0, 0.863158)
colors = PackedColorArray(0.784314, 0.486275, 1, 1, 0.2, 1, 1, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_kdw3i"]
gradient = SubResource("Gradient_e8g6m")

[sub_resource type="Curve" id="Curve_1sibw"]
_data = [Vector2(0, 0.754513), 0.0, -0.292015, 0, 0, Vector2(1, 0.0758123), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_5k051"]
curve = SubResource("Curve_1sibw")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_73prc"]
lifetime_randomness = 0.5
emission_shape = 2
emission_sphere_radius = 0.3
direction = Vector3(0, 0, 0)
spread = 180.0
gravity = Vector3(0, 0, 0)
damping_min = 2.0
damping_max = 2.0
scale_curve = SubResource("CurveTexture_5k051")
color_ramp = SubResource("GradientTexture1D_kdw3i")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_txvxt"]
vertex_color_use_as_albedo = true

[sub_resource type="BoxMesh" id="BoxMesh_h4hdo"]
material = SubResource("StandardMaterial3D_txvxt")
size = Vector3(0.4, 0.4, 0.4)

[sub_resource type="BoxShape3D" id="BoxShape3D_c8hlm"]
size = Vector3(2.09875, 0.5, 2)

[sub_resource type="Gradient" id="Gradient_p53yb"]
offsets = PackedFloat32Array(0.309322, 1)
colors = PackedColorArray(1, 0.704208, 0.63597, 1, 0.971742, 0.952957, 0.883089, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_tbydk"]
gradient = SubResource("Gradient_p53yb")

[sub_resource type="Curve" id="Curve_msc6w"]
_data = [Vector2(0, 0.845455), 0.0, 0.0, 0, 0, Vector2(1, 0.490909), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_4g3ka"]
curve = SubResource("Curve_msc6w")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_ufa6u"]
lifetime_randomness = 0.5
spread = 180.0
initial_velocity_min = 3.0
initial_velocity_max = 3.0
scale_curve = SubResource("CurveTexture_4g3ka")
color_ramp = SubResource("GradientTexture1D_tbydk")
attractor_interaction_enabled = false

[sub_resource type="BoxMesh" id="BoxMesh_24xbq"]
material = ExtResource("4_ioxtw")
size = Vector3(0.2, 0.2, 0.2)

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_0yrqs"]
lifetime_randomness = 0.5
spread = 180.0
initial_velocity_min = 1.5
initial_velocity_max = 1.5
scale_curve = SubResource("CurveTexture_4g3ka")
color_ramp = ExtResource("5_ny0xu")
attractor_interaction_enabled = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_u4ypk"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_dxb0f"]
radius = 25.0

[sub_resource type="CylinderShape3D" id="CylinderShape3D_6tlqf"]
radius = 14.0

[sub_resource type="CylinderShape3D" id="CylinderShape3D_1wxwy"]
radius = 37.0

[sub_resource type="CylinderShape3D" id="CylinderShape3D_m3a5c"]
radius = 25.0

[node name="MK1" type="CharacterBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
script = ExtResource("1_nlux1")
footsteps_sfx = ExtResource("2_nejo3")
metadata/_edit_group_ = true

[node name="CollisionShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.00298, 0)
shape = SubResource("CapsuleShape3D_mjw7r")

[node name="Rotating" type="Node3D" parent="."]

[node name="MK1" parent="Rotating" instance=ExtResource("7_v8gqy")]
transform = Transform3D(-2.18557e-08, 0, -0.5, 0, 0.5, 0, 0.5, 0, -2.18557e-08, 0, -0.5, 0)

[node name="mk1" parent="Rotating/MK1/Node2" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0491212, -0.00817687)

[node name="body" parent="Rotating/MK1/Node2/mk1" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.999234, 0.0391348, 0, -0.0391348, 0.999234, 0, 3.20313, 0.265625)

[node name="bodyJoint" parent="Rotating/MK1/Node2/mk1/body" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.999356, -0.0358738, 0, 0.0358738, 0.999356, 0, -0.0776786, 0)

[node name="leftUpperLeg" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/leftLegJoint" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.977203, -0.212304, 0, 0.212304, 0.977203, -0.357812, 8.88178e-16, 5.55112e-17)

[node name="leftLowerLeg" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/leftLegJoint/leftUpperLeg" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.929607, 0.368553, 0, -0.368553, 0.929607, -2.22045e-16, -1.00082, 0)

[node name="leftFeet" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/leftLegJoint/leftUpperLeg/leftLowerLeg" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.986612, -0.163084, 0, 0.163084, 0.986612, 0, -1.56064, 0.0078125)

[node name="rightUpperLeg" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/rightLegJoint" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.976524, -0.215408, 0, 0.215408, 0.976524, 0.357812, 8.88178e-16, 5.55112e-17)

[node name="rightLowerLeg" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/rightLegJoint/rightUpperLeg" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.939836, 0.341625, 0, -0.341625, 0.939836, 2.22045e-16, -1.00082, 0)

[node name="rightFeet" parent="Rotating/MK1/Node2/mk1/body/bodyJoint/rightLegJoint/rightUpperLeg/rightLowerLeg" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.990502, -0.137496, 0, 0.137496, 0.990502, 0, -1.56064, 0.0078125)

[node name="leftArmJoint" parent="Rotating/MK1/Node2/mk1/body" index="1"]
transform = Transform3D(1, 0, 0, 0, 0.21644, 0.976296, 0, -0.976296, 0.21644, -0.842188, 1.44844, 0.028125)

[node name="leftUpperArm" parent="Rotating/MK1/Node2/mk1/body/leftArmJoint" index="0"]
transform = Transform3D(0.97437, 0.00890791, 0.224774, -9.77889e-09, 0.999216, -0.0395994, -0.224951, 0.0385844, 0.973606, -0.140625, 0.009375, 1.11022e-16)

[node name="leftLowerArm" parent="Rotating/MK1/Node2/mk1/body/leftArmJoint/leftUpperArm" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.998565, 0.053564, 0, -0.053564, 0.998565, 0, 0, -0.99926)

[node name="rightArmJoint" parent="Rotating/MK1/Node2/mk1/body" index="2"]
transform = Transform3D(0.976296, 2.08616e-07, -0.216439, 0.216233, 0.0436184, 0.975367, 0.00944094, -0.999048, 0.0425845, 0.842188, 1.44844, 0.028125)

[node name="rightUpperArm" parent="Rotating/MK1/Node2/mk1/body/rightArmJoint" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.99544, -0.0953841, 0, 0.0953841, 0.99544, 0.140625, 0.009375, 1.11022e-16)

[node name="rightLowerArm" parent="Rotating/MK1/Node2/mk1/body/rightArmJoint/rightUpperArm" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.983799, -0.179275, 0, 0.179275, 0.983799, 0, 0, -0.99926)

[node name="rightHand" parent="Rotating/MK1/Node2/mk1/body/rightArmJoint/rightUpperArm/rightLowerArm" index="0"]
transform = Transform3D(1, 0, 0, 0, 0.991445, -0.130526, 0, 0.130526, 0.991445, 7.77156e-16, 0.0078125, -1.56845)

[node name="head" parent="Rotating/MK1/Node2/mk1/body" index="3"]
transform = Transform3D(0.986058, 0, 0.166401, 0, 1, 0, -0.166401, 0, 0.986058, -0.0625, 2.1875, 5.55112e-17)

[node name="FotonicGun" parent="Rotating" node_paths=PackedStringArray("stats") instance=ExtResource("1_aybfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.4, 1.7, 0.200305)
duration_time = 1.0
delay_time = 0.5
stats = NodePath("../../Stats")
projectile = ExtResource("4_lav24")
layer = 64
mask = 2
attack_type = 3

[node name="PrimaryParticles" parent="Rotating/FotonicGun" index="0"]
amount = 100
lifetime = 0.5
speed_scale = 0.7
explosiveness = 0.5
process_material = SubResource("ParticleProcessMaterial_73prc")
draw_pass_1 = SubResource("BoxMesh_h4hdo")

[node name="SFXEmitter" parent="Rotating/FotonicGun" index="4"]
event = ExtResource("4_tif1u")

[node name="GPUParticlesAttractorBox3D" type="GPUParticlesAttractorBox3D" parent="Rotating/FotonicGun"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0919647, 0, -1.49012e-08)
strength = 300.0
attenuation = 3.605
size = Vector3(2.67905, 2.38551, 2.50193)

[node name="DrillAttack" parent="Rotating" node_paths=PackedStringArray("stats") instance=ExtResource("3_stq0h")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.567953, 1.7099, 0.20543)
collision_layer = 4
collision_mask = 2
duration_time = 0.5
delay_time = 0.2
stats = NodePath("../../Stats")
attack_type = 1

[node name="Shape" parent="Rotating/DrillAttack" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.602568, 0, 0)
shape = SubResource("BoxShape3D_c8hlm")

[node name="PrimaryParticles" parent="Rotating/DrillAttack" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.828849, -0.00934613, 0)
amount = 100
speed_scale = 2.0
randomness = 0.5
process_material = SubResource("ParticleProcessMaterial_ufa6u")
draw_pass_1 = SubResource("BoxMesh_24xbq")

[node name="SecondaryParticles" parent="Rotating/DrillAttack" index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.828849, -0.00934613, 0)
amount = 50
speed_scale = 2.0
randomness = 0.5
process_material = SubResource("ParticleProcessMaterial_0yrqs")
draw_pass_1 = SubResource("BoxMesh_24xbq")

[node name="SFXEmitter" parent="Rotating/DrillAttack" index="5"]
event = ExtResource("8_em8a2")

[node name="AttackerAnimationTree" parent="Rotating" instance=ExtResource("8_2jfml")]
anim_player = NodePath("../MK1/AnimationPlayer")
active = true
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_u4ypk")

[node name="Fixed" type="Node3D" parent="."]

[node name="HitBox" parent="Fixed" node_paths=PackedStringArray("stats", "shields") instance=ExtResource("4_16kiu")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
collision_layer = 20
collision_mask = 34
script = ExtResource("5_akkc2")
stats = NodePath("../../Stats")
shields = NodePath("../Shield")

[node name="Shape" parent="Fixed/HitBox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.00259, 0)
shape = SubResource("CapsuleShape3D_mjw7r")

[node name="HitSfx" type="StudioEventEmitter3D" parent="Fixed/HitBox"]
event = ExtResource("11_mumii")

[node name="DeadSfx" type="StudioEventEmitter3D" parent="Fixed/HitBox"]
event = ExtResource("12_5capb")

[node name="HealthBar" parent="Fixed" node_paths=PackedStringArray("stats") instance=ExtResource("6_kvpei")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.4, 0)
stats = NodePath("../../Stats")
color_low = Color(0.74902, 0.203922, 0.203922, 1)
color_high = Color(0.301961, 0.952941, 0.301961, 1)

[node name="FollowingBrain" parent="Fixed" node_paths=PackedStringArray("rotating", "stats") instance=ExtResource("7_5nhoc")]
rotating = NodePath("../../Rotating")
switching_behaviour_distance = 5
stats = NodePath("../../Stats")

[node name="TargetRangeArea" parent="Fixed/FollowingBrain" index="0"]
collision_layer = 16
collision_mask = 8

[node name="TargetRangeShape" parent="Fixed/FollowingBrain/TargetRangeArea" index="0"]
shape = SubResource("CylinderShape3D_dxb0f")

[node name="AttackingBrain" parent="Fixed" node_paths=PackedStringArray("rotating", "far_attack", "near_attack", "stats") instance=ExtResource("8_okm3w")]
rotating = NodePath("../../Rotating")
far_attack = NodePath("../../Rotating/FotonicGun")
near_attack = NodePath("../../Rotating/DrillAttack")
switching_behaviour_distance = 2
stats = NodePath("../../Stats")

[node name="TargetRangeArea" parent="Fixed/AttackingBrain" index="0"]
collision_layer = 16
collision_mask = 8

[node name="TargetRangeShape" parent="Fixed/AttackingBrain/TargetRangeArea" index="0"]
shape = SubResource("CylinderShape3D_6tlqf")

[node name="WanderingBrain" parent="Fixed" node_paths=PackedStringArray("rotating", "stats") instance=ExtResource("13_bb7j5")]
rotating = NodePath("../../Rotating")
switching_behaviour_distance = 25
stats = NodePath("../../Stats")

[node name="TargetRangeArea" parent="Fixed/WanderingBrain" index="0"]
collision_layer = 16
collision_mask = 8

[node name="TargetRangeShape" parent="Fixed/WanderingBrain/TargetRangeArea" index="0"]
shape = SubResource("CylinderShape3D_1wxwy")

[node name="AvoidingBrain" parent="Fixed" node_paths=PackedStringArray("rotating", "stats") instance=ExtResource("14_6tyvy")]
rotating = NodePath("../../Rotating")
switching_behaviour_distance = 5
stats = NodePath("../../Stats")

[node name="TargetRangeArea" parent="Fixed/AvoidingBrain" index="0"]
collision_layer = 16
collision_mask = 8

[node name="TargetRangeShape" parent="Fixed/AvoidingBrain/TargetRangeArea" index="0"]
shape = SubResource("CylinderShape3D_m3a5c")

[node name="Shield" parent="Fixed" instance=ExtResource("12_2fip4")]
max_health = 5.0

[node name="MinimapIcon" type="Sprite3D" parent="Fixed"]
transform = Transform3D(-50, -7.54979e-06, 6.60024e-15, 0, -2.18557e-06, -1, 7.54979e-06, -50, 4.37114e-08, 0, 20, 0)
texture_filter = 2
texture = ExtResource("22_sufty")

[node name="Stats" type="Node" parent="."]
script = ExtResource("9_q1fbs")
max_health = 20.0
damage = 1.5
speed = 6.0

[node name="FootstepsTimer" type="Timer" parent="."]
one_shot = true

[connection signal="is_attacking" from="Rotating/FotonicGun" to="Rotating/AttackerAnimationTree" method="set_attacking"]
[connection signal="is_attacking" from="Rotating/DrillAttack" to="Rotating/AttackerAnimationTree" method="set_attacking"]
[connection signal="dead" from="Stats" to="Fixed/HitBox" method="die"]

[editable path="Rotating/MK1"]
[editable path="Rotating/FotonicGun"]
[editable path="Rotating/DrillAttack"]
[editable path="Fixed/HitBox"]
[editable path="Fixed/FollowingBrain"]
[editable path="Fixed/AttackingBrain"]
[editable path="Fixed/WanderingBrain"]
[editable path="Fixed/AvoidingBrain"]
